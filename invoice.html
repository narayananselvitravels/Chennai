<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Invoice - NST Travels</title>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap" rel="stylesheet">
  <style>
    body { font-family:'Poppins',sans-serif; background:#f9f9f9; max-width:800px; margin:40px auto; padding:20px; }
    h2 { color:#4b2aad; }
    .invoice-box {
      border:1px solid #ccc; padding:20px; background:#fff;
    }
    select, button {
      padding:10px; font-size:16px; margin-bottom:20px; width:100%;
      border-radius:5px; border:1px solid #ccc;
    }
    table { width:100%; border-collapse:collapse; margin-top:20px }
    th, td { text-align:left; padding:8px; border-bottom:1px solid #ddd }
    th { background:#4b2aad; color:#fff }
  </style>
</head>
<body>

<h2>ðŸ§¾ NST Travels - Invoice</h2>

<select id="tripSelect" onchange="generateInvoice()">
  <option value="">-- Select Trip ID --</option>
</select>

<div class="invoice-box" id="invoiceContent">
  <p>Select a Trip ID to generate invoice.</p>
</div>

<script>
  const key = "shared-trips";

  function loadTripIDs() {
    const trips = JSON.parse(localStorage.getItem(key) || "[]");
    const select = document.getElementById("tripSelect");
    trips.forEach((trip, index) => {
      const opt = document.createElement("option");
      opt.value = index;
      opt.text = `${trip.id} - ${trip.date}`;
      select.appendChild(opt);
    });
  }

  function generateInvoice() {
    const index = document.getElementById("tripSelect").value;
    if (index === "") {
      document.getElementById("invoiceContent").innerHTML = "<p>Select a Trip ID to generate invoice.</p>";
      return;
    }

    const trips = JSON.parse(localStorage.getItem(key) || "[]");
    const trip = trips[index];
    if (!trip) return;

    const html = `
      <h3>Invoice for ${trip.id}</h3>
      <p><strong>Date:</strong> ${trip.date}</p>
      <p><strong>Customer:</strong> ${trip.custName} (${trip.custNumber})</p>
      <p><strong>Duty:</strong> ${trip.duty || "-"}</p>
      <p><strong>Pickup:</strong> ${trip.pickup}</p>
      <p><strong>Drop:</strong> ${trip.drop}</p>
      <p><strong>Driver:</strong> ${trip.driverName} (${trip.driverNumber})</p>
      <p><strong>Vehicle:</strong> ${trip.vehicleModel} (${trip.vehicleNo})</p>

      <table>
        <tr><th>Description</th><th>Details</th></tr>
        <tr><td>Time</td><td>${trip.start} - ${trip.end} (${trip.duration} hrs)</td></tr>
        <tr><td>Extra Hours</td><td>${trip.extraHours || 0}</td></tr>
        <tr><td>KM</td><td>${trip.startKM} - ${trip.endKM} = ${trip.totalKM} km</td></tr>
        <tr><td>Extra KM</td><td>${trip.extraKM || 0}</td></tr>
        <tr><td>Parking</td><td>â‚¹${trip.parking || 0}</td></tr>
        <tr><td>Toll</td><td>â‚¹${trip.toll || 0}</td></tr>
        <tr><td><strong>Total Amount</strong></td><td><strong>â‚¹${trip.totalAmount}</strong></td></tr>
        <tr><td>Payment Status</td><td>${trip.paymentStatus}</td></tr>
      </table>

      <p><strong>Note:</strong> ${trip.note || "-"}</p>
    `;

    document.getElementById("invoiceContent").innerHTML = html;
  }

  window.onload = loadTripIDs;
</script>

</body>
</html>