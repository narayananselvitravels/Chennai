<!DOCTYPE html><html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>NST Travels ‚Äì Invoice</title>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap" rel="stylesheet">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
  <style>
    * { box-sizing: border-box; }
    body {
      font-family: 'Poppins', sans-serif;
      background: #f5f5fa;
      color: #333;
      padding: 0;
      margin: 0;
    }
    .invoice-container {
      width: 210mm;
      min-height: 297mm;
      background: #fff;
      padding: 30px 40px;
      margin: auto;
      border-radius: 6px;
      box-shadow: 0 0 8px rgba(0,0,0,0.1);
      color: #000;
    }
    .header {
      border-bottom: 2px solid #4b2aad;
      padding-bottom: 15px;
      margin-bottom: 20px;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
    .header h1 {
      margin: 0;
      color: #4b2aad;
      font-size: 26px;
      font-weight: 700;
    }
    .section {
      margin-bottom: 20px;
    }
    .row {
      display: flex;
      justify-content: space-between;
      gap: 40px;
    }
    .box {
      flex: 1;
      background: #f9f9fc;
      padding: 10px 15px;
      border-radius: 4px;
      font-weight: 600;
    }
    .box strong {
      display: block;
      margin-top: 5px;
      color: #4b2aad;
    }
    .details-table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 10px;
      font-weight: 600;
    }
    .details-table th, .details-table td {
      border: 1px solid #ccc;
      padding: 10px;
      font-size: 14px;
    }
    .details-table th {
      background-color: #4b2aad;
      color: #fff;
      text-align: left;
    }
    .summary {
      margin-top: 20px;
      float: right;
      width: 250px;
    }
    .summary .line {
      display: flex;
      justify-content: space-between;
      margin-bottom: 8px;
      font-size: 14px;
      font-weight: 600;
    }
    .summary .line strong {
      font-weight: 700;
    }
    .note {
      margin-top: 40px;
      font-size: 13px;
      color: #555;
      font-weight: 600;
    }
    .buttons {
      margin-top: 20px;
      text-align: center;
    }
    .buttons button {
      background-color: #4b2aad;
      color: #fff;
      padding: 10px 18px;
      border: none;
      border-radius: 5px;
      margin: 5px;
      font-size: 14px;
      font-weight: 600;
      cursor: pointer;
    }
    .buttons button:hover {
      background-color: #381d89;
    }
    input, textarea {
      width: 100%;
      font-family: 'Poppins';
      font-size: 14px;
      font-weight: 600;
      border: none;
      background: transparent;
      resize: none;
    }
    input:focus, textarea:focus {
      outline: none;
    }
    @media print {
      .buttons, #tripSelector { display: none !important; }
      body { background: white; }
    }
  </style>
</head>
<body>
<div class="invoice-container" id="invoice">
  <div class="header">
    <h1>üöñ NST Travels</h1>
    <div>
      <div><strong>Trip ID:</strong> <input id="invId" value="#NST000"/></div>
      <div><strong>Date:</strong> <input id="invDate" value="--"/></div>
    </div>
  </div>  <div class="section row">
    <div class="box">
      <strong>üë§ Customer</strong>
      <div>Name: <input id="custName" value=""/></div>
      <div>Phone: <input id="custNumber" value=""/></div>
    </div>
    <div class="box">
      <strong>üë®‚Äç‚úàÔ∏è Driver</strong>
      <div>Name: <input id="driverName" value=""/></div>
      <div>Phone: <input id="driverNumber" value=""/></div>
    </div>
  </div>  <div class="section row">
    <div class="box">
      <strong>üöò Vehicle Info</strong>
      <div>Model: <input id="vehicleModel" value=""/></div>
      <div>Number: <input id="vehicleNo" value=""/></div>
    </div>
    <div class="box">
      <strong>üìç Trip Details</strong>
      <div>Pickup: <input id="pickup" value=""/></div>
      <div>Drop: <input id="drop" value=""/></div>
    </div>
  </div>  <table class="details-table" id="chargesTable">
    <thead>
      <tr><th>Item</th><th>Details</th><th>Amount (‚Çπ)</th></tr>
    </thead>
    <tbody id="chargeDetails">
      <tr><td>Package</td><td><input class="details" value="Innova Crysta ‚Äì 8 hrs / 80 KM"/></td><td><input class="amount" value="7500" /></td></tr>
      <tr><td>Extra Hours</td><td><input class="details" value="2 hrs √ó ‚Çπ1000" /></td><td><input class="amount" value="" /></td></tr>
      <tr><td>Extra KM</td><td><input class="details" value="10 km √ó ‚Çπ20" /></td><td><input class="amount" value="" /></td></tr>
      <tr><td>Toll</td><td><input class="details" value="--" /></td><td><input class="amount" value="150" /></td></tr>
      <tr><td>Parking</td><td><input class="details" value="--" /></td><td><input class="amount" value="100" /></td></tr>
    </tbody>
  </table>  <div class="summary">
    <div class="line"><span>Subtotal:</span><span id="subtotal">‚Çπ0</span></div>
    <div class="line"><span>Discount:</span><input type="number" id="discount" value="0" oninput="calculateTotal()" /></div>
    <hr />
    <div class="line"><strong>Total:</strong><strong id="total">‚Çπ0</strong></div>
  </div>  <div class="note">
    <textarea id="note">Thank you for choosing NST Travels. For any queries, contact us at +91-9876543210.</textarea>
  </div>  <div class="buttons">
    <button onclick="window.print()">üñ®Ô∏è Print</button>
    <button onclick="downloadPDF()">üìÑ Download PDF</button>
    <button onclick="downloadImage()">üñºÔ∏è Download Image</button>
    <button onclick="shareWhatsApp()">üì§ Share via WhatsApp</button>
  </div>
</div><script>
function parseAmount(detail) {
  const match = detail.match(/(\d+)\s*[^\d]*√ó[^\d]*‚Çπ?(\d+)/);
  if (match) return parseInt(match[1]) * parseInt(match[2]);
  return 0;
}

function calculateTotal() {
  let subtotal = 0;
  const rows = document.querySelectorAll('#chargesTable tbody tr');
  rows.forEach(row => {
    const detailInput = row.querySelector('.details');
    const amountInput = row.querySelector('.amount');
    const detail = detailInput.value.trim();
    let amount = parseInt(amountInput.value);
    if (!amount || amount === 0) {
      amount = parseAmount(detail);
      amountInput.value = amount;
    }
    subtotal += amount;
  });
  document.getElementById("subtotal").innerText = `‚Çπ${subtotal}`;
  const discount = parseInt(document.getElementById("discount").value) || 0;
  const total = subtotal - discount;
  document.getElementById("total").innerText = `‚Çπ${total}`;
}

function downloadPDF() {
  const element = document.getElementById("invoice");
  const opt = {
    margin: 0,
    filename: `Invoice_${document.getElementById("invId").value}_${document.getElementById("invDate").value}.pdf`,
    image: { type: 'jpeg', quality: 0.98 },
    html2canvas: { scale: 2 },
    jsPDF: { unit: 'mm', format: 'a4', orientation: 'portrait' }
  };
  html2pdf().set(opt).from(element).save();
}

function downloadImage() {
  html2canvas(document.getElementById("invoice")).then(canvas => {
    const link = document.createElement('a');
    link.download = `Invoice_${document.getElementById("invId").value}_${document.getElementById("invDate").value}.png`;
    link.href = canvas.toDataURL();
    link.click();
  });
}

function shareWhatsApp() {
  const msg = `üßæ *NST Invoice*\nTrip ID: ${document.getElementById("invId").value}\nCustomer: ${document.getElementById("custName").value}\nTotal: ${document.getElementById("total").innerText}\n\n${document.getElementById("note").value}`;
  window.open("https://wa.me/?text=" + encodeURIComponent(msg), "_blank");
}

window.onload = calculateTotal;
</script></body>
</html>